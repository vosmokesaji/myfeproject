<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>高中同学聚会</title>
    <link rel="stylesheet" href="./css/fullpage.css">
    <link rel="stylesheet" href="./css/index.css">
    <script src="./js/jq.js"></script>
    <script src="./js/fullpage.js"></script>

</head>
<body>
    <div id="fullpage" class="fullpage">

        <div class="section my-section my-section-0">
            <p class="title title-1">辛兴中学</p>
            <p class="title title-2">高三班同学聚会</p>
            <p class="time">2019.12</p>
            <p class="tips">开始观看</p>
        </div>
        <div class="section my-section my-section-1">
            <img class="my-people-img my-image-1" data-index="1" data-lock="true" src="./images/peoples/1.jpeg" alt="">
            <img class="my-people-img my-image-2" data-index="2" data-lock="true" src="./images/peoples/6.jpeg" alt="">
            <img class="my-people-img my-image-3" data-index="3" data-lock="true" src="./images/peoples/3.jpeg" alt="">
            <img class="my-people-img my-image-4" data-index="4" data-lock="true" src="./images/peoples/7.jpeg" alt="">
            <img class="my-people-img my-image-5" data-index="5" data-lock="true" src="./images/peoples/5.jpeg" alt="">
        </div>
        <div class="section my-section my-section-2">
            <img class="my-people-img my-image-1" data-index="1" data-lock="true" src="./images/peoples/1.jpeg" alt="">
            <img class="my-people-img my-image-2" data-index="2" data-lock="true" src="./images/peoples/6.jpeg" alt="">
            <img class="my-people-img my-image-3" data-index="3" data-lock="true" src="./images/peoples/3.jpeg" alt="">
            <img class="my-people-img my-image-4" data-index="4" data-lock="true" src="./images/peoples/4.jpeg" alt="">
            <img class="my-people-img my-image-5" data-index="5" data-lock="true" src="./images/peoples/7.jpeg" alt="">
        </div>
        <div class="section my-section my-section-3">
            <img class="my-people-img my-image-1" data-index="1" data-lock="true" src="./images/peoples/6.jpeg" alt="">
            <img class="my-people-img my-image-2" data-index="2" data-lock="true" src="./images/peoples/2.jpeg" alt="">
            <img class="my-people-img my-image-3" data-index="3" data-lock="true" src="./images/peoples/3.jpeg" alt="">
            <img class="my-people-img my-image-4" data-index="4" data-lock="true" src="./images/peoples/7.jpeg" alt="">
            <img class="my-people-img my-image-5" data-index="5" data-lock="true" src="./images/peoples/5.jpeg" alt="">
        </div>
        <div class="section my-section my-section-4">
            <img class="my-people-img my-image-1" data-index="1" data-lock="true" src="./images/peoples/7.jpeg" alt="">
            <img class="my-people-img my-image-2" data-index="2" data-lock="true" src="./images/peoples/2.jpeg" alt="">
            <img class="my-people-img my-image-3" data-index="3" data-lock="true" src="./images/peoples/3.jpeg" alt="">
            <img class="my-people-img my-image-4" data-index="4" data-lock="true" src="./images/peoples/4.jpeg" alt="">
            <img class="my-people-img my-image-5" data-index="5" data-lock="true" src="./images/peoples/6.jpeg" alt="">
        </div>
        <div class="section my-section my-section-5">
            <img class="my-people-img my-image-1" data-index="1" data-lock="true" src="./images/peoples/7.jpeg" alt="">
            <img class="my-people-img my-image-2" data-index="2" data-lock="true" src="./images/peoples/2.jpeg" alt="">
            <img class="my-people-img my-image-3" data-index="3" data-lock="true" src="./images/peoples/6.jpeg" alt="">
            <img class="my-people-img my-image-4" data-index="4" data-lock="true" src="./images/peoples/4.jpeg" alt="">
            <img class="my-people-img my-image-5" data-index="5" data-lock="true" src="./images/peoples/1.jpeg" alt="">
        </div>
        
        <div class="section my-section my-section-6">
            <p class="thx">谢谢观看</p>
            <p class="replay">再看一遍</p>
        </div>
    </div>
    
    <audio src="./music/不说再见.mp3" id="myAudio" class="audio"></audio>
    <div class="playBtn"></div>
    <script>
        

        $(document).ready(function() {
            
            var fullpageObj = new fullpage('#fullpage', {
                anchors: ['firstPage', 'secondPage', 'thirdPage', 'fourthPage', 'lastPage'],


                // 某个方块载入职后
                afterLoad: function(origin, destination, direction){
                    var loadedSection = this,
                        scale = 1,          // 放大倍数
                        rotate = 0,         // 旋转角度
                        x = 0,              // 横向位移
                        y = 0,              // 纵向位移
                        delay = 0;

                    $(origin.item).find(".my-people-img")
                            .removeAttr('style').attr('data-lock', 'true');

                    
                    $(destination.item).find(".my-people-img").each(function(index, ele){

                        scale = 1 - Math.random() * 0.1;
                        rotate = 5 - Math.random() * 10;
                        x = 1 - Math.random() * 2;
                        y = 1 - Math.random() * 2;
                        delay = (index + 1) * 0.4 + 0;


                        $(ele)
                        .css({
                            'transition': `transform .6s ease-in-out ${delay}s, opacity .6s ease-in-out ${delay}s`,
                            'transform' : `scale(${scale}) rotate(${rotate}deg) translateX(${x}vw) translateY(${y}vh)`,
                            'opacity' : 1
                        })
                        .attr('data-lock', 'true');
                    })
                }

            });

            $("body")
                .on("tap", ".my-people-img", function(){
                    var $this = $(this),
                        parents = $this.parent(),
                        targetIndex = Number($this.attr('data-index')),
                        
                        scale = 1,          // 放大倍数
                        rotate = 0,         // 旋转角度
                        x = 0,              // 横向位移
                        y = 0;              // 纵向位移
                    
                        
                    parents.find(".my-people-img").each(function(index, ele){
                        var thisIndex = Number($(ele).attr('data-index'));

                        scale = 1 - Math.random() * 0.1;
                        rotate = 5 - Math.random() * 10;
                        y = 1 - Math.random() * 2
                        x = 1 - Math.random() * 2;

                        if(thisIndex <= targetIndex){
                            y -= 3;
                        }else{
                            y += 26;
                        }

                        if(thisIndex == targetIndex){
                            scale = 1 + Math.random() * 0.1;
                        }

                        $(ele)
                        .css({
                            'transition': `all .3s ease-in-out`,
                            'transform' : `scale(${scale}) rotate(${rotate}deg) translateX(${x}vw) translateY(${y}vh)`,
                        })
                    })
                    
                })
                .on("tap", ".playBtn", function(){
                    
                    var x = document.getElementById("myAudio");
                    if($(this).hasClass("playing")){
                        $(this).removeClass("playing");
                        x.pause();
                    }else{
                        $(this).addClass("playing");
                        x.play();
                    }
                    
                })
                .on("tap",".tips", function(){
                    // fullpageObj.
                    fullpage_api.moveTo(2);

                    $(".playBtn").addClass("playing");
                    document.getElementById("myAudio").play();

                })
                .on("tap",".replay", function(){
                    fullpage_api.moveTo(2);
                });

        });
    </script>
</body>
</html>